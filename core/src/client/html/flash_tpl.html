<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script type="text/javascript">
		var ajxpResourcesFolder = '<?php print(CLIENT_RESOURCES_FOLDER); ?>';
		var ajxpServerAccessPath = '<?php print(SERVER_ACCESS); ?>';
</script>
<style>
img{
    border: none;
}
body
{
	padding: 0px;
	padding-left: 0px;
	margin: 0px;
	background-image: url('<?php print(CLIENT_RESOURCES_FOLDER);?>/images/strip.png');
}

div, a
{
    font-family: Trebuchet MS;
    font-size: 12px;
}
a.disabled
{
	filter:alpha(opacity=30);
	opacity: 0.3;
	-moz-opacity:0.3;	
	cursor:default;
}
a.enabled
{
	filter:alpha(opacity=100);
	opacity: 1;
	-moz-opacity:1;
	cursor:pointer;
}
a
{
    display: inline;
    
    text-align: center;
    cursor: pointer;    
}
</style>
</head>
<body bgcolor="ffffff">
<form name="upload_form" id="upload_form" action="<?php print($_SERVER['SCRIPT_NAME']);?>?get_action=upload&dir=%2F&ajxp_sessid=<?php echo session_id(); ?>">
<div style="border: 0px solid #ccc; border-bottom: 0px; width: 422px; height:470px; padding: 0px 0px;">
<script language="javascript" type="text/javascript">
function UploadComplete()
{
    // Put upload complete handler here
}

var url = '<?php print($_SERVER['SCRIPT_NAME']);?>?get_action=upload&ajxp_sessid=<?php echo session_id(); ?>';
if(parent.ajaxplorer){
	url = url+'&dir='+escape(parent.ajaxplorer.filesList.getCurrentRep());
}
var names = new Array(
"maxFileSizeLimitText", 
"maxFileSizeText", 
"HTTPErrorText", 
"IOErrorText", 
"securityErrorText",
"uploadedText",
"removeText",
"addFilesText",
"clearFilesText",
"uploadFilesText",
"cancelUploadText",
"totalFilesText",
"totalSizeText",
"bytesText", 
"existingFilesFound", 
"overwrite", 
"skip", 
"rename", 
"UploadLimitsTitle", 
"UploadLimitsSizePerFile", 
"UploadLimitsTotalSize", 
"UploadLimitsFilesNumber");

var texts= new Array(
"<?php echo $mess[252]; ?>", 
"<?php echo $mess[211]; ?>", 
"<?php echo $mess[253]; ?>",
"<?php echo $mess[254]; ?>",
"<?php echo $mess[255]; ?>",
"<?php echo $mess[256]; ?>",
"<?php echo $mess[257]; ?>",
"<?php echo $mess[214]; ?>",
"<?php echo $mess[216]; ?>",
"<?php echo $mess[77]; ?>",
"<?php echo $mess[232]; ?>",
"<?php echo $mess[258]; ?>",
"<?php echo $mess[259]; ?>",
"<?php echo $mess[260]; ?>", 
"<?php echo $mess[262]; ?>", 
"<?php echo $mess[263]; ?>", 
"<?php echo $mess[264]; ?>",
"<?php echo $mess[6]; ?>",
"<?php echo $mess[281]; ?>",
"<?php echo $mess[282]; ?>",
"<?php echo $mess[283]; ?>",
"<?php echo $mess[284]; ?>"
);

function getTranslationsAsParam()
{
    var ret = new Array();
	var i = 0;
	for (var i = 0; i < names.length; i++)
	{
	    ret.push(names[i] + '=' + escape(texts[i]));
	}
	return ret.join('&');
}

<?php 
    $UploadMaxSize = Utils::convertBytes(ini_get('upload_max_filesize'));
    $confMaxSize = ConfService::getConf("UPLOAD_MAX_FILE");
    if($confMaxSize != 0 &&  $confMaxSize < $UploadMaxSize) $UploadMaxSize = $confMaxSize;
    $confTotalSize = ConfService::getConf("UPLOAD_MAX_TOTAL");
    $confTotalNumber = ConfService::getConf("UPLOAD_MAX_NUMBER");
    
	$FlashVar = '&completeFunction=UploadComplete()&fileTypes=*.*&fileTypeDescription=All%20files&totalUploadSize='.$confTotalSize.'&fileSizeLimit='.$UploadMaxSize.'&maxFileNumber='.$confTotalNumber;
?>
var FlashVarValue = getTranslationsAsParam()+"<?php echo $FlashVar; ?>" + "&currentFolderFiles=" + parent.ajaxplorer.filesList.getfileNamesAsString("__AJXP_SEP__")+"&separator=__AJXP_SEP__&uploadPage=";

document.write('<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="422" height="470" id="fileUpload" align="middle">\
<param name="allowScriptAccess" value="sameDomain" /> \
<param name="movie" value="<?php print(CLIENT_RESOURCES_FOLDER);?>/flash/FlashFileUpload.swf" /> \
<param name="quality" value="high" /> \
<param name="wmode" value="transparent"> \
<param name="FlashVars" value="' + FlashVarValue + escape(url) + '">\
<embed src="<?php print(CLIENT_RESOURCES_FOLDER);?>/flash/FlashFileUpload.swf" \
FlashVars="' + FlashVarValue + escape(url) + '" \
quality="high" wmode="transparent" width="422" height="470" name="fileUpload" align="middle" allowScriptAccess="sameDomain" type="application/x-shockwave-flash"\
pluginspage="http://www.macromedia.com/go/getflashplayer" />\
</object>');



</script>

</div>
</form>
</body>
</html>
